/**
 * @preserve This generated code and related technologies are covered by patents
 * or patents pending by Appcelerator, Inc.
 *
 * WARNING: this file is generated and will be overwritten
 * It was generated from <%=gen.filename%> on <%=new Date%>
 */
@import JavaScriptCore;
#import <hyperloop.h>
<% gen.imports.forEach(function(i) { -%>
@import <%=i%>;
<% }) -%>

// implementations define this
extern NSData* HyperloopDecompressBuffer (NSData*);

<% externs.forEach(function(e) { -%>
<%- e -%>;

<% }) -%>


@interface <%=gen.prefix%><%=gen.name%> : NSObject<HyperloopModule>
+(JSValueRef)load:(JSContextRef)context;
@end

@implementation <%=gen.prefix%><%=gen.name%>

+(NSData*)buffer
{
	static UInt8 data[] = {
		<%=gen.jsBuffer %>
	};
	return [NSData dataWithBytes:((void*)data) length:<%=gen.jsBuffer.length%>];
}

+(JSValueRef)load:(JSContextRef)ctx
{
	@autoreleasepool
	{
		JSObjectRef object = JSContextGetGlobalObject(ctx);

<%if (gen.requires_JSBuffer) { -%>
		// register our JSBuffer
		RegisterJSBuffer(ctx, object);
<%} -%>

		<%-indentify(code,'		') %>

		return NULL;
	}
}

@end
